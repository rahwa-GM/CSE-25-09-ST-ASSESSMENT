{% load static %}

{% load crispy_forms_tags %}

<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

<style>
    .btn:hover {
        background-color: white;
        color: black;
        border: 2px solid black;
}
</style>

{% if messages %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        {% for message in messages %}
            {{ message }}
        {% endfor %}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
{% endif %}

    <div class="container py-5">
        <div class="row">
            <!-- Upload Section -->
            <div class="col-md-6">
                <h2 class="fw-bold mb-4">Upload your music</h2>

                <form method="POST" enctype="multipart/form-data" novalidate> <!-- Required when uploading files (like audio or images) -->
                    {% csrf_token %}
                    {{ form|crispy }}

                    <button type='submit' class="btn btn-dark w-100 mt-3" >UPLOAD</button>
                </form>
            </div>

       <!-- Song List -->
<div class="col-md-6">
    <h4 class="fw-bold mb-4">Songs</h4>

    {% for song in songs %}
    <div class="d-flex align-items-center border p-3 rounded mb-3">

        <!-- Circular Cover Image Centered -->
        <div class="d-flex flex-column align-items-center me-3">
            {% if song.cover %}
                <img src="{{ song.cover.url }}" 
                     width="80" height="80" 
                     class="rounded-circle mb-2">
            {% else %}
                <img src="{% static 'images/placeholder.jpg' %}" 
                     width="80" height="80" 
                     class="rounded-circle mb-2">
            {% endif %}
        </div>

        <div class="flex-grow-1">
            <h5 class="m-0">{{ song.title }}</h5>
            <small class="text-muted">
                {{ song.artist }} • {{ song.album }} • {{ song.year }}
            </small>
        </div>

        <audio controls style="width:120px;">
            <source src="{{ song.audio.url }}" type="audio/mpeg">
        </audio>

    </div>
    {% endfor %}
</div>
